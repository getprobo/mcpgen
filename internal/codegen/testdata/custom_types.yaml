info:
  title: custom-types-test
  version: 1.0.0
  description: Test all custom type mapping scenarios

components:
  schemas:
    # Standard library types with go.probo.inc/mcpgen/type
    Timestamp:
      type: string
      format: date-time
      description: A timestamp
      go.probo.inc/mcpgen/type: time.Time

    Duration:
      type: string
      description: A duration
      go.probo.inc/mcpgen/type: time.Duration

    # External package types
    UUID:
      type: string
      format: uuid
      description: A UUID
      go.probo.inc/mcpgen/type: github.com/google/uuid.UUID

    Decimal:
      type: string
      description: A decimal number
      go.probo.inc/mcpgen/type: github.com/shopspring/decimal.Decimal

    # JSON raw message
    Metadata:
      type: object
      description: Raw JSON metadata
      go.probo.inc/mcpgen/type: json.RawMessage

    # Regular enum (should be generated)
    Status:
      type: string
      enum: [pending, in_progress, completed, cancelled]
      description: Task status

    # Regular object (should be generated)
    Task:
      type: object
      description: A task
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        title:
          type: string
          description: Task title
        status:
          $ref: "#/components/schemas/Status"
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          anyOf:
            - $ref: "#/components/schemas/Timestamp"
            - type: "null"
        duration:
          $ref: "#/components/schemas/Duration"
        metadata:
          $ref: "#/components/schemas/Metadata"
        tags:
          type: array
          items:
            type: string
          description: Task tags
        priority:
          type: integer
          description: Priority level
      required: [id, title, status, createdAt]

    # Object with all nullable custom types
    OptionalFields:
      type: object
      properties:
        optionalTimestamp:
          anyOf:
            - $ref: "#/components/schemas/Timestamp"
            - type: "null"
        optionalUUID:
          anyOf:
            - $ref: "#/components/schemas/UUID"
            - type: "null"
        optionalDecimal:
          anyOf:
            - $ref: "#/components/schemas/Decimal"
            - type: "null"

    # Nested objects
    Project:
      type: object
      properties:
        id:
          $ref: "#/components/schemas/UUID"
        name:
          type: string
        tasks:
          type: array
          items:
            $ref: "#/components/schemas/Task"
        createdAt:
          $ref: "#/components/schemas/Timestamp"
      required: [id, name, createdAt]

    # Update input with omittable fields
    UpdateTaskInput:
      type: object
      description: Input for partial task update
      properties:
        id:
          $ref: "#/components/schemas/UUID"
          description: Task ID to update
        title:
          type: string
          description: New title (omit to keep unchanged, null to clear)
          go.probo.inc/mcpgen/omittable: true
        status:
          $ref: "#/components/schemas/Status"
          description: New status (omit to keep unchanged)
          go.probo.inc/mcpgen/omittable: true
        priority:
          type: integer
          description: New priority (omit to keep unchanged, null to clear)
          go.probo.inc/mcpgen/omittable: true
        tags:
          type: array
          items:
            type: string
          description: New tags (omit to keep unchanged, null to clear)
          go.probo.inc/mcpgen/omittable: true
      required: [id]

tools:
  - name: create_task
    description: Create a new task
    inputSchema:
      $ref: "#/components/schemas/Task"

  - name: update_task
    description: Update task fields (partial update with omittable fields)
    inputSchema:
      $ref: "#/components/schemas/UpdateTaskInput"

  - name: create_project
    description: Create a new project
    inputSchema:
      $ref: "#/components/schemas/Project"

resources:
  - uriTemplate: "task://{id}"
    name: Task Resource
    description: Get a task by ID
    mimeType: application/json
    schema:
      $ref: "#/components/schemas/Task"

  - uriTemplate: "project://{id}"
    name: Project Resource
    description: Get a project by ID
    mimeType: application/json
    schema:
      $ref: "#/components/schemas/Project"

prompts:
  - name: task_summary
    description: Generate a task summary
    arguments:
      - name: taskId
        description: The task ID
        required: true
      - name: includeMetadata
        description: Include metadata in summary
        required: false
